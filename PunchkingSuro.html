<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>라라 펀치킹 수로 계산기</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
            background-color: #f8fafc;
            color: #1e293b;
        }
        .card {
            transition: all 0.3s ease;
            border: 1px solid #e2e8f0;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        }
        
        input[type="number"] {
            transition: all 0.2s ease;
            border: 2px solid #e2e8f0;
            background: #f8fafc;
        }
        input[type="number"]:focus {
            border-color: #4ade80;
            box-shadow: 0 0 0 3px rgba(74, 222, 128, 0.2);
        }
        
        .btn-green {
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            transition: all 0.3s ease;
        }
        .btn-green:hover {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(34, 197, 94, 0.25);
        }
        
        /* 헤더 스타일 개선 */
        h1 {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* 결과 텍스트 스타일 */
        #damage, #damage2, #score, #score2 {
            font-family: 'Pretendard', sans-serif;
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            padding: 0.25rem 0;
            margin: 0;
            line-height: 1.5;
            text-align: center;
        }

        .result-container {
            margin-top: 1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;
        }

        /* 툴팁 스타일 추가 */
        .tooltip {
            position: relative;
            display: inline-block;
        }
        
        .tooltip .tooltip-content {
            visibility: hidden;
            width: 420px;
            background-color: rgba(255, 255, 255, 0.95);
            text-align: center;
            padding: 1rem;
            position: absolute;
            z-index: 1000;
            top: 125%;
            left: 50%;
            margin-left: -210px;
            opacity: 0;
            transition: opacity 0.3s;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            border-radius: 8px;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .tooltip:hover .tooltip-content {
            visibility: visible;
            opacity: 1;
        }
        
        .tooltip img {
            width: 100%;
            margin-bottom: 0.5rem;
        }
        
        .info-button {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
            border: none;
            border-radius: 0.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .info-button:hover {
            background: linear-gradient(135deg, #22c55e 0%, #16a34a 100%);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(34, 197, 94, 0.25);
        }
        
        .info-icon {
            color: #4ade80;
            font-size: 1.25rem;
        }
        
        .info-text {
            color: #1e293b;
            font-weight: 500;
        }

        /* 모바일 대응 */
        @media (max-width: 768px) {
            .tooltip .tooltip-content {
                position: fixed;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 90vw;
                max-height: 80vh;
                margin-left: 0;
                overflow-y: auto;
                background-color: white;
                padding: 1.5rem;
                -webkit-overflow-scrolling: touch;
            }

            .tooltip img {
                width: 100%;
                height: auto;
                margin: 0.5rem 0;
            }

            /* 닫기 버튼 추가 */
            .close-tooltip {
                position: absolute;
                top: 0.5rem;
                right: 0.5rem;
                background: rgba(0, 0, 0, 0.7);
                color: white;
                border: none;
                border-radius: 50%;
                width: 2.5rem;
                height: 2.5rem;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 1001;
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container mx-auto px-4 py-12 max-w-6xl">
        <h1 class="text-5xl font-black text-center mb-12">라라 펀치킹 수로 계산기</h1>
        
        <div class="flex flex-col items-center mb-8">
            <div class="tooltip">
                <div class="flex items-center">
                    <i class="fas fa-book info-icon"></i>
                    <span class="ml-2 info-text">설명서</span>
                </div>
                <div class="tooltip-content">
                    <button class="close-tooltip">×</button>
                    <img src="펀치킹 환산.png" alt="펀치킹 환산" class="w-full mb-2">
                    <img src="설명서.png" alt="설명서" class="w-full">
                </div>
            </div>
        </div>

        <div class="search-form mb-8">
            <input type="text" id="characterName" placeholder="캐릭터 이름을 입력하세요" class="border border-gray-300 rounded-md px-4 py-2 w-full mb-4 focus:outline-none focus:ring-2 focus:ring-green-500 text-center">
            <button onclick="searchCharacter()" class="w-full btn-green text-white font-bold py-2 px-4 rounded transition duration-300">검색</button>
            <div class="loading" id="loading">구현중..</div>
            <div class="error" id="error"></div>
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-8">
            <div class="card bg-white rounded-lg shadow-md p-6">
                <div class="flex flex-col items-center mb-4">
                    <h2 class="text-2xl font-semibold text-center text-gray-700">펀치킹용 계산기</h2>
                </div>
                <p class="mt-2 mb-4 text-sm text-center text-gray-600">계산기 제작자 : 엘리시움 아기양라라쟝</p>
                <input type="number" id="hexa" placeholder="일반 환산 입력" class="border border-gray-300 rounded-md px-4 py-2 w-full mb-4 focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                <button onclick="calculate()" class="w-full btn-green text-white font-bold py-2 px-4 rounded transition duration-300">계산하기</button>
                <div class="result-container">
                    <p id="damage" class="text-lg text-center text-gray-700"></p>
                    <p id="score" class="text-lg text-center text-gray-700"></p>
                </div>
            </div>
            
            <div class="card bg-white rounded-lg shadow-md p-6">
                <h2 class="text-2xl font-semibold mb-4 text-center text-gray-700">수로용 계산기</h2>
                <p class="mt-2 mb-4 text-sm text-center text-gray-600">펀치킹, 수로 표본 제공 : 스카니아 엥새</p>
                <input type="number" id="hexa2" placeholder="헥사 환산 아님" class="border border-gray-300 rounded-md px-4 py-2 w-full mb-4 focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                <button onclick="calculate2()" class="w-full btn-green text-white font-bold py-2 px-4 rounded transition duration-300">계산하기</button>
                <div class="result-container">
                    <p id="damage2" class="text-lg text-center text-gray-700"></p>
                    <p id="score2" class="text-lg text-center text-gray-700"></p>
                </div>
            </div>
        </div>
        
        <div class="card bg-white rounded-lg shadow-md p-6">
            <h2 class="text-2xl font-semibold mb-4 text-center text-gray-700">스킬 레벨 입력</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                <div>
                    <label for="MasteryCore1" class="block mb-2 text-sm font-medium text-gray-700 text-center">정뿌</label>
                    <input type="number" id="MasteryCore1" placeholder="0~30" min="0" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="MasteryCore2" class="block mb-2 text-sm font-medium text-gray-700 text-center">분출</label>
                    <input type="number" id="MasteryCore2" placeholder="1~30" min="1" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="OriginCore" class="block mb-2 text-sm font-medium text-gray-700 text-center">꽃누리</label>
                    <input type="number" id="OriginCore" placeholder="1~30" min="1" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="FifthCore1" class="block mb-2 text-sm font-medium text-gray-700 text-center">해강산</label>
                    <input type="number" id="FifthCore1" placeholder="0~30" min="0" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="FifthCore2" class="block mb-2 text-sm font-medium text-gray-700 text-center">굽이굽이</label>
                    <input type="number" id="FifthCore2" placeholder="0~30" min="0" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="FifthCore3" class="block mb-2 text-sm font-medium text-gray-700 text-center">큰기지개</label>
                    <input type="number" id="FifthCore3" placeholder="0~30" min="0" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
                <div>
                    <label for="FifthCore4" class="block mb-2 text-sm font-medium text-gray-700 text-center">용솟음</label>
                    <input type="number" id="FifthCore4" placeholder="0~30" min="0" max="30" class="border border-gray-300 rounded-md px-3 py-2 w-full focus:outline-none focus:ring-2 focus:ring-green-500 text-center"> <!-- 중앙 정렬 -->
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener("contextmenu", (event) => event.preventDefault()); // 우클릭 방지
        document.addEventListener("keydown", (event) => {
            if (event.key === "F12" || (event.ctrlKey && event.shiftKey && event.key === "I")) {
                event.preventDefault(); // F12, Ctrl+Shift+I 방지
            }   
        });
        async function searchCharacter() {
            const characterName = document.getElementById('characterName').value;
            const loading = document.getElementById('loading');
            const error = document.getElementById('error');

            if (!characterName) {
                error.textContent = '캐릭터 이름을 입력해주세요.';
                error.style.display = 'block';
                return;
            }

            loading.style.display = 'block';
            error.style.display = 'none';

            try {
                const apiKey = process.env.MAPLE_API_KEY; // 환경 변수에서 API 키 가져오기
                
                // 날짜 설정 (어제 날짜 사용)
                const yesterday = new Date();
                yesterday.setDate(yesterday.getDate() - 1);
                const dateStr = yesterday.toISOString().split('T')[0];

                // 1. Character OCID 조회
                const ocidResponse = await fetch(`https://open.api.nexon.com/maplestory/v1/id?character_name=${encodeURIComponent(characterName)}`, {
                    headers: {
                        'x-nxopen-api-key': apiKey
                    }
                });

                if (!ocidResponse.ok) {
                    throw new Error('캐릭터를 찾을 수 없습니다.');
                }

                const ocidData = await ocidResponse.json();
                
                // 2. 캐릭터 기본 정보 조회
                const characterResponse = await fetch(`https://open.api.nexon.com/maplestory/v1/character/basic?ocid=${ocidData.ocid}&date=${dateStr}`, {
                    headers: {
                        'x-nxopen-api-key': apiKey
                    }
                });

                // 3. HEXA 매트릭스 정보 조회
                const hexaResponse = await fetch(`https://open.api.nexon.com/maplestory/v1/character/hexamatrix?ocid=${ocidData.ocid}&date=${dateStr}`, {
                    headers: {
                        'x-nxopen-api-key': apiKey
                    }
                });

                if (!characterResponse.ok || !hexaResponse.ok) {
                    throw new Error('캐릭터 정보를 가져올 수 없습니다.');
                }

                const characterData = await characterResponse.json();
                const hexaData = await hexaResponse.json();

                if (characterData.character_class != '라라'){
                    throw new Error('라라가 아닙니다.');
                }

                // HEXA 코어 레벨 업데이트
                document.getElementById("MasteryCore1").value = hexaData.character_hexa_core_equipment[1].hexa_core_level || 0;
                document.getElementById("MasteryCore2").value = hexaData.character_hexa_core_equipment[2].hexa_core_level || 0;
                document.getElementById("OriginCore").value = hexaData.character_hexa_core_equipment[0].hexa_core_level || 0;
                document.getElementById("FifthCore1").value = hexaData.character_hexa_core_equipment[4].hexa_core_level || 0;
                document.getElementById("FifthCore2").value = hexaData.character_hexa_core_equipment[6].hexa_core_level || 0;
                document.getElementById("FifthCore3").value = hexaData.character_hexa_core_equipment[3].hexa_core_level || 0;
                document.getElementById("FifthCore4").value = hexaData.character_hexa_core_equipment[5].hexa_core_level || 0;

            } catch (err) {
                console.error('Error:', err);
                error.textContent = err.message;
                error.style.display = 'block';
            } finally {
                loading.style.display = 'none';
            }
        }
        function HexaCalculate() {
          // 스킬 레벨 입력에서 값 가져오기 및 숫자로 변환
          let MasteryCore1 = parseInt(document.getElementById("MasteryCore1").value);
          let MasteryCore2 = parseInt(document.getElementById("MasteryCore2").value);
          let OriginCore = parseInt(document.getElementById("OriginCore").value);
          let FifthCore1 = parseInt(document.getElementById("FifthCore1").value);
          let FifthCore2 = parseInt(document.getElementById("FifthCore2").value);
          let FifthCore3 = parseInt(document.getElementById("FifthCore3").value);
          let FifthCore4 = parseInt(document.getElementById("FifthCore4").value);
      
          let OriginShare = 16.74; // 오리진
      
          let MasteryShare1_1 = 7.34; // 정뿌
          let MasteryShare1_2 = 4.23; // 산꼬마
          let MasteryShare1_3 = 4.15; // 산의 씨앗
      
          let MasteryShare2_1 = 11.17; // 해분출
          let MasteryShare2_2 = 9.29; // 바람분출
          let MasteryShare2_3 = 6.77; // 강분출
      
          let FifthShare1 = 10.85; // 해강산
          let FifthShare2 = 11.45; // 굽이굽이
          let FifthShare3 = 10.28; // 큰기지개
          let FifthShare4 = 5.54; // 용솟음
      
          let nowOriginShare; // 오리진
      
          let nowMasteryShare1_1; // 정뿌
          let nowMasteryShare1_2; // 산꼬마
          let nowMasteryShare1_3; // 산의 씨앗
      
          let nowMasteryShare2_1; // 해분출
          let nowMasteryShare2_2; // 바람분출
          let nowMasteryShare2_3; // 강분출
      
          let nowFifthShare1; // 해강산
          let nowFifthShare2; // 굽이굽이
          let nowFifthShare3; // 큰기지개
          let nowFifthShare4; // 용솟음
      
          // 헥사강화로 인한 오리진 감소 계산
          let nowOriginDamage = (1050 + OriginCore * 35) * 7 * 8 + (695 + OriginCore * 23) * 14 * 64; // 1~30레벨 공식
          if(OriginCore > 9) nowOriginDamage *= 1.021; // 10레벨 이상 효과
          if(OriginCore > 19) nowOriginDamage *= 1.008; // 20레벨 이상 효과
          if(OriginCore > 29) nowOriginDamage *= 1.05; // 30레벨 효과
          
          let OriginDamage = (1050 + 30 * 35) * 7 * 8 + (695 + 30 * 23) * 14 * 64; // 만렙 데미지
          OriginDamage *= 1.0806264 // 만렙 효과
      
          nowOriginShare = (nowOriginDamage / OriginDamage) * OriginShare;
          if(OriginCore == 0) nowOriginShare = 0;
          
          // 정뿌 감소 계산
          let nowMastery1_1Damage;
      
          if (MasteryCore1 == 0) { 
              nowMastery1_1Damage = 340 + 50;
          } else {
              nowMastery1_1Damage = 480 + (MasteryCore1 * 12);
          }
      
          let Mastery1_1Damage = 480 + 360;
      
          nowMasteryShare1_1 = (nowMastery1_1Damage / Mastery1_1Damage) * MasteryShare1_1;
      
          // 산꼬마 감소 계산
          let nowMastery1_2Damage;
      
          if(MasteryCore1 == 0) nowMastery1_2Damage = 410 + 16;
          nowMastery1_2Damage = 426 + 60 + (MasteryCore1 * 20);
      
          let Mastery1_2Damage = 426 + 60 + 600;
      
          nowMasteryShare1_2 = (nowMastery1_2Damage / Mastery1_2Damage) * MasteryShare1_2;
          
          // 산의 씨앗 감소 계산
          let nowMastery1_3Damage;
      
          if(MasteryCore1 == 0) nowMastery1_3Damage = 395 + 16;
          nowMastery1_3Damage = 409 + 60 + (MasteryCore1 * 20);
      
          let Mastery1_3Damage = 409 + 60 + 600;
      
          nowMasteryShare1_3 = (nowMastery1_3Damage / Mastery1_3Damage) * MasteryShare1_3;
          
          // 해분출 감소 계산
          let nowMastery2_1Damage;
      
          nowMastery2_1Damage = (760 + MasteryCore2 * 10) * 6 * 6 + (450 + MasteryCore2 * 5) * 60 + ((465 + MasteryCore2 * 7) * 3 + (465 + MasteryCore2 * 7 * 0.9) * 3 * 4) * 28;
      
          let Mastery2_1Damage = (760 + 300) * 6 * 6 + (450 + 150) * 60 + ((465 + 210) * 3 + (465 + 30 * 7 * 0.9) * 3 * 4) * 28;
      
          nowMasteryShare2_1 = (nowMastery2_1Damage / Mastery2_1Damage) * MasteryShare2_1;
      
          // 바람분출 감소 계산
          let nowMastery2_2Damage;
      
          nowMastery2_2Damage = (510 + MasteryCore2 * 6);
      
          let Mastery2_2Damage = (510 + 30 * 6);
      
          nowMasteryShare2_2 = (nowMastery2_2Damage / Mastery2_2Damage) * MasteryShare2_2;
      
          // 강분출 감소 계산
          let nowMastery2_3Damage;
      
          nowMastery2_3Damage = (930 + MasteryCore2 * 13) * 8 * 8 + (780 + MasteryCore2 * 11) * 5 * 20;
      
          let Mastery2_3Damage = (930 + 30 * 13) * 8 * 8 + (780 + 30 * 11) * 5 * 20;
      
          nowMasteryShare2_3 = (nowMastery2_3Damage / Mastery2_3Damage) * MasteryShare2_3;
      
          // 해강산 감소 계산
          let nowFifth1Damage;
          if(FifthCore1 == 0) nowFifth1Damage = 1;
          else if(FifthCore1 < 10) nowFifth1Damage = (110+FifthCore1)/100; // 1~9레벨
          else if(FifthCore1 < 20) nowFifth1Damage = (115+FifthCore1)/100; // 10~19레벨
          else if(FifthCore1 < 30) nowFifth1Damage = (120+FifthCore1)/100; // 20~29레벨
          else nowFifth1Damage = 1.6;
          nowFifthShare1 = (nowFifth1Damage/1.6) * FifthShare1
      
          // 굽이굽이 감소 계산
          let nowFifth2Damage;
          if(FifthCore2 == 0) nowFifth2Damage = 1;
          else if(FifthCore2 < 10) nowFifth2Damage = (110+FifthCore2)/100; // 1~9레벨
          else if(FifthCore2 < 20) nowFifth2Damage = (115+FifthCore2)/100; // 10~19레벨
          else if(FifthCore2 < 30) nowFifth2Damage = (120+FifthCore2)/100; // 20~29레벨
          else nowFifth2Damage = 1.6;
          nowFifthShare2 = (nowFifth2Damage/1.6) * FifthShare2
      
          // 큰기지개 감소 계산
          let nowFifth3Damage;
          if(FifthCore3 == 0) nowFifth3Damage = 1;
          else if(FifthCore3 < 10) nowFifth3Damage = (110+FifthCore3)/100; // 1~9레벨
          else if(FifthCore3 < 20) nowFifth3Damage = (115+FifthCore3)/100; // 10~19레벨
          else if(FifthCore3 < 30) nowFifth3Damage = (120+FifthCore3)/100; // 20~29레벨
          else nowFifth3Damage = 1.6;
          nowFifthShare3 = (nowFifth3Damage/1.6) * FifthShare3
      
          // 용솟음 감소 계산
          let nowFifth4Damage;
          if(FifthCore4 == 0) nowFifth4Damage = 1;
          else if(FifthCore4 < 10) nowFifth4Damage = (110+FifthCore4)/100; // 1~9레벨
          else if(FifthCore4 < 20) nowFifth4Damage = (115+FifthCore4)/100; // 10~19레벨
          else if(FifthCore4 < 30) nowFifth4Damage = (120+FifthCore4)/100; // 20~29레벨
          else nowFifth4Damage = 1.6;
          nowFifthShare4 = (nowFifth4Damage/1.6) * FifthShare4
      
          // 헥사 풀일때 데미지
          let HexaFullDamage = 
          OriginShare +
          MasteryShare1_1 +
          MasteryShare1_2 +
          MasteryShare1_3 +
          MasteryShare2_1 +
          MasteryShare2_2 +
          MasteryShare2_3 +
          FifthShare1 +
          FifthShare2 +
          FifthShare3 +
          FifthShare4;
      
          // 현재 나오는 데미지
          let HexaNowDamage = 
          nowOriginShare +
          nowMasteryShare1_1 +
          nowMasteryShare1_2 +
          nowMasteryShare1_3 +
          nowMasteryShare2_1 +
          nowMasteryShare2_2 +
          nowMasteryShare2_3 +
          nowFifthShare1 +
          nowFifthShare2 +
          nowFifthShare3 +
          nowFifthShare4;
      
          return HexaNowDamage / HexaFullDamage;
        }
      
        function calculate() {
          var HexaLevel = HexaCalculate()
          var hexa = document.getElementById("hexa").value;
          var hexaDamage = 0.0004880131 * HexaLevel;
          var damage = parseInt(hexa) * hexaDamage;
          var score = 0;
        /* 구 버전 펀치킹 데이터
            if (damage >= 13671) {
                score = 1600;
                if (damage < 153671) {
                    score += (damage - 13671) / 350;
                } else {
                    score += (153671 - 13671) / 350;
                    score += (damage - 153671) / 3500;
                }
            }
        */
          if (damage >= 13671) {
              score = 1250;
              score += (damage - 13671) / 80;
          }   
           // 결과 숫자에 디자인 적용
          var damageElement = document.getElementById("damage");
          var scoreElement = document.getElementById("score");
          damageElement.style.fontSize = "18px";
          damageElement.style.fontWeight = "bold";
          damageElement.style.color = "#000000";
          scoreElement.style.fontSize = "18px";
          scoreElement.style.fontWeight = "bold";
          scoreElement.style.color = "#000000";
      
          damage = damage / 1000;
          if ( score > 5000 ) { score = 5000; }
          damageElement.innerText = "데미지: " + damage.toFixed(1) + "조" + "\n점수: " + score.toFixed(0); 
          // damageElement.innerText = "데미지: " + damage + "억";
        }
      
        function calculate2() {
          var HexaLevel = HexaCalculate()
          var hexa2 = document.getElementById("hexa2").value;
          var hexaDamage2 = 0.005278 * HexaLevel;
          var damage2 = parseInt(hexa2) * hexaDamage2;
          var score2 = 0;
      
          if (damage2 <= 60) {
              score2 = damage2 / 6;
          }
          else if (damage2 <= 210) {
              score2 = 10 + (damage2 - 60) / 7.5;
          }
          else if (damage2 <= 1710) {
              score2 = 30 + (damage2 - 210) / 15;
          }
          else {
              score2 = 130 + (damage2 - 1710) / 30;
          }
          var score3 = score2 / 1.09
      
         // 결과 숫자에 디자인 적용
          var damage2Element = document.getElementById("damage2");
          var score2Element = document.getElementById("score2");
          damage2Element.style.fontSize = "18px";
          damage2Element.style.fontWeight = "bold";
          damage2Element.style.color = "#000000";
          score2Element.style.fontSize = "18px";
          score2Element.style.fontWeight = "bold";
          score2Element.style.color = "#000000";
          if ( score2 > 200000) {
                score2 = 0;
          }
          // damage2Element.innerText = "Damage: " + damage2.toFixed(0); 데미지 출력은 굳이 안해도 될듯?
          score2Element.innerText = "일반인 기준: " + score3.toFixed(0) + "\n최고점 기준: " + score2.toFixed(0);
        }

        // 모바일 환경에서 닫기 버튼 동작
        document.addEventListener('DOMContentLoaded', function() {
          const closeButton = document.querySelector('.close-tooltip');
          const tooltipContent = document.querySelector('.tooltip-content');
          const tooltipTrigger = document.querySelector('.tooltip');
          
          if (closeButton) {
              closeButton.addEventListener('click', function(e) {
                  e.stopPropagation(); // 이벤트 버블링 방지
                  tooltipContent.style.visibility = 'hidden';
                  tooltipContent.style.opacity = '0';
              });
          }

          // 모바일에서 설명서 버튼 클릭 시 툴팁 표시
          if (tooltipTrigger) {
              tooltipTrigger.addEventListener('click', function(e) {
                  // 현재 툴팁이 보이는 상태인지 확인
                  const isVisible = tooltipContent.style.visibility === 'visible';
                  
                  // 툴팁 상태 토글
                  tooltipContent.style.visibility = isVisible ? 'hidden' : 'visible';
                  tooltipContent.style.opacity = isVisible ? '0' : '1';
              });
            }
        });
      </script>
</body>
</html>
